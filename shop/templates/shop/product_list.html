{% extends "base.html" %}

{% block contact %}
<style>
.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Modern Product Card Styles */
.product-card {
    position: relative;
    background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(147, 51, 234, 0.2);
    border-radius: 16px;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    height: 320px; /* Further reduced height */
    display: flex;
    flex-direction: column;
    box-shadow: 0 4px 20px rgba(147, 51, 234, 0.1);
}

.dark .product-card {
    background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
    border: 1px solid rgba(255,255,255,0.2);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
}

.product-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px rgba(147, 51, 234, 0.15);
    border-color: rgba(147, 51, 234, 0.3);
}

.product-card.cursor-pointer {
    cursor: pointer;
}

.product-card.cursor-pointer:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px rgba(147, 51, 234, 0.2);
    border-color: rgba(147, 51, 234, 0.4);
    background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.8) 100%);
}

.dark .product-card.cursor-pointer:hover {
    background: linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.08) 100%);
}

.dark .product-card:hover {
    box-shadow: 0 20px 40px rgba(147, 51, 234, 0.25);
    border-color: rgba(147, 51, 234, 0.4);
}

.product-image-container {
    position: relative;
    height: 140px; /* Further reduced height */
    overflow: hidden;
    background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%);
    cursor: pointer;
}

.product-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
}

.product-card:hover .product-image {
    transform: scale(1.05);
}

.product-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(transparent, rgba(0,0,0,0.7));
    padding: 12px 10px 8px; /* Further reduced padding */
    color: white;
}

.product-title {
    font-size: 12px; /* Further reduced font size */
    font-weight: 600;
    margin-bottom: 4px; /* Further reduced margin */
    line-height: 1.2; /* Reduced line height */
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}

/* Product description styles removed - using product-short-description instead */

.category-tag {
    display: inline-block;
    background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
    color: white;
    padding: 2px 5px; /* Further reduced padding */
    border-radius: 8px; /* Further reduced border radius */
    font-size: 8px; /* Further reduced font size */
    font-weight: 500;
    margin-bottom: 4px; /* Further reduced margin */
    box-shadow: 0 2px 4px rgba(139, 92, 246, 0.3);
}

.product-content {
    padding: 10px; /* Further reduced padding */
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    position: relative;
    z-index: 2;
}
}

.product-info {
    margin-bottom: 6px; /* Further reduced margin */
}

.product-rating {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 8px;
    padding: 4px 6px;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0.6) 100%);
    border-radius: 12px;
    border: 1px solid rgba(147, 51, 234, 0.1);
}

.stars {
    display: flex;
    gap: 2px;
}

.stars i {
    font-size: 10px;
    color: #fbbf24;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.stars i.fas {
    color: #f59e0b;
}

.rating-text {
    font-size: 10px;
    color: #6b7280;
    font-weight: 500;
    background: rgba(147, 51, 234, 0.1);
    padding: 2px 6px;
    border-radius: 8px;
    border: 1px solid rgba(147, 51, 234, 0.2);
}

.product-price {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
    padding: 6px 8px;
    background: linear-gradient(135deg, rgba(147, 51, 234, 0.05) 0%, rgba(147, 51, 234, 0.02) 100%);
    border-radius: 12px;
    border: 1px solid rgba(147, 51, 234, 0.15);
}

.current-price {
    font-size: 14px;
    font-weight: 700;
    color: #7c3aed;
    text-shadow: 0 1px 2px rgba(124, 58, 237, 0.1);
    background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.original-price {
    font-size: 11px;
    color: #9ca3af;
    text-decoration: line-through;
    font-weight: 500;
    opacity: 0.8;
}

.discount-badge {
    position: absolute;
    top: 12px;
    right: 12px;
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 600;
    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
    z-index: 10;
}

.bestseller-badge {
    position: absolute;
    top: 12px;
    left: 12px;
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 600;
    box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
    z-index: 10;
}

.new-badge {
    position: absolute;
    top: 12px;
    left: 12px;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 600;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
    z-index: 10;
}

/* Action Buttons - Left Side Positioning */
.wishlist-btn {
    position: absolute;
    bottom: 6px; /* Further reduced from 8px */
    left: 6px; /* Changed from right to left */
    width: 28px; /* Further reduced size */
    height: 28px; /* Further reduced size */
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    border: none;
    border-radius: 50%;
    color: white;
    display: flex !important;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    z-index: 20;
    opacity: 1 !important;
    visibility: visible !important;
}

.wishlist-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 16px rgba(239, 68, 68, 0.4);
}

.wishlist-btn i {
    font-size: 10px; /* Further reduced font size */
}

.cart-button {
    position: absolute;
    bottom: 6px; /* Further reduced from 8px */
    left: 40px; /* Position to the right of wishlist button */
    width: 32px; /* Further reduced size */
    height: 32px; /* Further reduced size */
    background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
    border: none;
    border-radius: 50%;
    color: white;
    display: flex !important;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
    z-index: 20;
    opacity: 1 !important;
    visibility: visible !important;
}

.cart-button:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 16px rgba(139, 92, 246, 0.4);
}

.cart-button i {
    font-size: 12px; /* Further reduced font size */
}

/* Force button visibility */
.wishlist-btn,
.cart-button {
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
    pointer-events: auto !important;
}

/* Ensure buttons are above all other elements */
.product-card .wishlist-btn,
.product-card .cart-button {
    z-index: 999 !important;
    position: absolute !important;
}

/* Short description styles */
.product-short-description {
    font-size: 11px;
    color: #4b5563;
    line-height: 1.4;
    margin-bottom: 8px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    font-weight: 400;
    text-align: justify;
    padding: 0 2px;
}

.dark .product-short-description {
    color: #d1d5db;
}

.dark .product-rating {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.dark .product-price {
    background: linear-gradient(135deg, rgba(147, 51, 234, 0.1) 0%, rgba(147, 51, 234, 0.05) 100%);
    border: 1px solid rgba(147, 51, 234, 0.3);
}

.dark .rating-text {
    background: rgba(147, 51, 234, 0.2);
    border: 1px solid rgba(147, 51, 234, 0.4);
    color: #e5e7eb;
}

/* Product actions container */
.product-actions {
    position: relative;
    margin-top: auto;
    padding-top: 6px; /* Further reduced padding */
}

/* Debug styles removed */

/* Responsive Grid */
.products-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr); /* Fixed 4 columns for desktop */
    gap: 16px; /* Increased gap for better spacing */
    padding: 16px 0;
}

@media (max-width: 1024px) {
    .products-grid {
        grid-template-columns: repeat(3, 1fr); /* 3 columns for tablets */
        gap: 14px;
        padding: 14px 0;
    }
}

@media (max-width: 768px) {
    .products-grid {
        grid-template-columns: repeat(2, 1fr) !important; /* 2 columns for mobile */
        gap: 12px !important;
        padding: 12px 0 !important;
        max-width: 100% !important;
        overflow-x: hidden !important;
    }
    
    .product-card {
        height: 300px !important; /* Reduced height for mobile */
        max-width: 100% !important;
        overflow: hidden !important;
    }
    
    .product-image-container {
        height: 120px !important; /* Reduced height for mobile */
    }
    
    .product-content {
        padding: 8px !important; /* Reduced padding for mobile */
    }
    
    .product-title {
        font-size: 11px !important; /* Smaller font for mobile */
        line-height: 1.2 !important;
        margin-bottom: 4px !important;
    }
    
    .category-tag {
        font-size: 7px !important;
        padding: 1px 4px !important;
        margin-bottom: 4px !important;
    }
    
    .product-short-description {
        font-size: 10px !important;
        line-height: 1.4 !important;
        margin-bottom: 6px !important;
        -webkit-line-clamp: 2 !important; /* Show fewer lines on mobile */
        padding: 0 1px !important;
    }
    
    .product-rating {
        gap: 4px !important;
        margin-bottom: 6px !important;
        padding: 3px 5px !important;
    }
    
    .stars i {
        font-size: 9px !important;
    }
    
    .rating-text {
        font-size: 9px !important;
        padding: 1px 4px !important;
    }
    
    .product-price {
        gap: 6px !important;
        margin-bottom: 6px !important;
        padding: 4px 6px !important;
    }
    
    .current-price {
        font-size: 13px !important; /* Smaller font for mobile */
        font-weight: 700;
    }
    
    .original-price {
        font-size: 10px !important;
    }
    
    .wishlist-btn {
        width: 26px !important;
        height: 26px !important;
        bottom: 6px !important;
        left: 6px !important;
    }
    
    .cart-button {
        width: 30px !important;
        height: 30px !important;
        bottom: 6px !important;
        left: 38px !important;
    }
    
    .wishlist-btn i {
        font-size: 9px !important;
    }
    
    .cart-button i {
        font-size: 11px !important;
    }
    
    .stars i {
        font-size: 7px !important; /* Better star size for mobile */
    }
    
    .rating-text {
        font-size: 8px !important;
    }
}

@media (max-width: 480px) {
    .products-grid {
        grid-template-columns: repeat(2, 1fr) !important; /* Keep 2 columns on very small screens */
        gap: 8px !important;
        padding: 8px 0 !important;
        margin: 0 4px !important;
    }
    
    .product-card {
        height: 280px !important; /* Further reduced for very small screens */
        margin: 0 !important;
    }
    
    .product-image-container {
        height: 110px !important;
    }
    
    .product-content {
        padding: 6px !important;
    }
    
    .product-title {
        font-size: 10px !important;
        line-height: 1.1 !important;
        margin-bottom: 3px !important;
    }
    
    .category-tag {
        font-size: 6px !important;
        padding: 1px 3px !important;
        margin-bottom: 3px !important;
    }
    
    .product-short-description {
        font-size: 8px !important;
        line-height: 1.2 !important;
        margin-bottom: 4px !important;
        -webkit-line-clamp: 2 !important; /* Show fewer lines on very small screens */
    }
    
    .current-price {
        font-size: 11px !important;
    }
    
    .original-price {
        font-size: 8px !important;
    }
    
    .wishlist-btn {
        width: 24px !important;
        height: 24px !important;
        bottom: 4px !important;
        left: 4px !important;
    }
    
    .cart-button {
        width: 28px !important;
        height: 28px !important;
        bottom: 4px !important;
        left: 32px !important;
    }
    
    .wishlist-btn i {
        font-size: 8px !important;
    }
    
    .cart-button i {
        font-size: 10px !important;
    }
    
    .stars i {
        font-size: 6px !important;
    }
    
    .rating-text {
        font-size: 7px !important;
    }
}

/* List View Button Styles */
.wishlist-btn-list {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    border: none;
    border-radius: 50%;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    z-index: 10;
    position: relative;
}

.wishlist-btn-list:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 16px rgba(239, 68, 68, 0.4);
}

.wishlist-btn-list i {
    font-size: 14px;
}

.cart-button-list {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
    border: none;
    border-radius: 50%;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
    z-index: 10;
    position: relative;
}

.cart-button-list:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 16px rgba(139, 92, 246, 0.4);
}

.cart-button-list i {
    font-size: 14px;
}

/* Ensure list view buttons are above the clickable overlay */
.wishlist-btn-list,
.cart-button-list {
    z-index: 20 !important;
    position: relative !important;
}

/* Responsive adjustments for list view */
@media (max-width: 768px) {
    .wishlist-btn-list,
    .cart-button-list {
        width: 32px;
        height: 32px;
    }
    
    .wishlist-btn-list i,
    .cart-button-list i {
        font-size: 12px;
    }
}

@media (max-width: 480px) {
    .wishlist-btn-list,
    .cart-button-list {
        width: 28px;
        height: 28px;
    }
    
    .wishlist-btn-list i,
    .cart-button-list i {
        font-size: 11px;
    }
}

/* List View Specific Styles */
.product-card.list-view {
    display: flex !important;
    flex-direction: row !important;
    height: auto !important;
    min-height: 120px !important;
    padding: 12px !important;
    margin-bottom: 16px !important;
}

.product-card.list-view .product-image-container {
    width: 120px !important;
    height: 120px !important;
    flex-shrink: 0 !important;
    margin-right: 16px !important;
}

.product-card.list-view .product-content {
    flex: 1 !important;
    display: flex !important;
    flex-direction: column !important;
    justify-content: space-between !important;
    padding: 0 !important;
}

.product-card.list-view .product-info {
    margin-bottom: 12px !important;
}

.product-card.list-view .product-title {
    font-size: 16px !important;
    margin-bottom: 8px !important;
    line-height: 1.4 !important;
}

.product-card.list-view .category-tag {
    font-size: 10px !important;
    padding: 3px 8px !important;
    margin-bottom: 8px !important;
}

.product-card.list-view .product-short-description {
    font-size: 13px !important;
    line-height: 1.5 !important;
    margin-bottom: 12px !important;
    -webkit-line-clamp: 3 !important;
    color: #4b5563 !important;
    font-weight: 400 !important;
}

.dark .product-card.list-view .product-short-description {
    color: #d1d5db !important;
}

.product-card.list-view .product-rating {
    margin-bottom: 12px !important;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%) !important;
    border: 1px solid rgba(147, 51, 234, 0.15) !important;
    border-radius: 12px !important;
    padding: 6px 8px !important;
}

.dark .product-card.list-view .product-rating {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%) !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
}

.product-card.list-view .product-price {
    margin-bottom: 12px !important;
    background: linear-gradient(135deg, rgba(147, 51, 234, 0.08) 0%, rgba(147, 51, 234, 0.03) 100%) !important;
    border: 1px solid rgba(147, 51, 234, 0.2) !important;
    border-radius: 12px !important;
    padding: 8px 10px !important;
}

.dark .product-card.list-view .product-price {
    background: linear-gradient(135deg, rgba(147, 51, 234, 0.15) 0%, rgba(147, 51, 234, 0.08) 100%) !important;
    border: 1px solid rgba(147, 51, 234, 0.4) !important;
}

.product-card.list-view .product-actions {
    position: static !important;
    display: flex !important;
    gap: 8px !important;
    margin-top: 0 !important;
    padding-top: 0 !important;
}

.product-card.list-view .wishlist-btn,
.product-card.list-view .cart-button {
    position: static !important;
    width: 36px !important;
    height: 36px !important;
}

.product-card.list-view .wishlist-btn i,
.product-card.list-view .cart-button i {
    font-size: 14px !important;
}

/* Responsive List View */
@media (max-width: 768px) {
    .product-card.list-view {
        flex-direction: column !important;
        padding: 10px !important;
        min-height: auto !important;
    }
    
    .product-card.list-view .product-image-container {
        width: 100% !important;
        height: 140px !important;
        margin-right: 0 !important;
        margin-bottom: 12px !important;
    }
    
    .product-card.list-view .product-title {
        font-size: 14px !important;
    }
    
    .product-card.list-view .product-short-description {
        font-size: 11px !important;
    }
    
    .product-card.list-view .wishlist-btn,
    .product-card.list-view .cart-button {
        width: 32px !important;
        height: 32px !important;
    }
    
    .product-card.list-view .wishlist-btn i,
    .product-card.list-view .cart-button i {
        font-size: 12px !important;
    }
}

@media (max-width: 480px) {
    .product-card.list-view {
        padding: 8px !important;
    }
    
    .product-card.list-view .product-image-container {
        height: 120px !important;
        margin-bottom: 8px !important;
    }
    
    .product-card.list-view .product-title {
        font-size: 13px !important;
        margin-bottom: 6px !important;
    }
    
    .product-card.list-view .product-short-description {
        font-size: 10px !important;
        margin-bottom: 8px !important;
    }
    
    .product-card.list-view .wishlist-btn,
    .product-card.list-view .cart-button {
        width: 28px !important;
        height: 28px !important;
    }
    
    .product-card.list-view .wishlist-btn i,
    .product-card.list-view .cart-button i {
        font-size: 11px !important;
    }
}

/* Placeholder styles */
.placeholder-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    color: #9ca3af;
    background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
}

.placeholder-icon {
    font-size: 32px;
    margin-bottom: 8px;
    opacity: 0.5;
}

.placeholder-text {
    font-size: 12px;
    text-align: center;
    opacity: 0.7;
}
</style>
<div class="min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <h2 class="text-3xl font-bold text-center mb-8">محصولات ما</h2>
        
        <!-- Circular Cosmetic Filter Box -->
        <div class="relative mb-8 flex justify-end">
            <!-- Circular Compact Design -->
            <div id="cosmetic-compact" class="relative">
                <!-- Compact Base (Closed State) -->
                <div id="compact-base" class="w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-gradient-to-br from-pink-400 via-purple-500 to-indigo-500 shadow-2xl cursor-pointer transform transition-all duration-500 hover:scale-110 relative overflow-hidden border-4 border-white/30" onclick="toggleCompact()">
                    <!-- Mirror Effect -->
                    <div class="absolute inset-1 rounded-full bg-gradient-to-br from-pink-200/80 to-purple-200/80 shadow-inner border-2 border-white/60">
                        <!-- Reflection -->
                        <div class="absolute top-1.5 left-1.5 sm:top-2 sm:left-2 w-3 h-3 sm:w-4 sm:h-4 bg-white/40 rounded-full blur-sm"></div>
                        <div class="absolute bottom-2 right-2 sm:bottom-3 sm:right-3 w-1.5 h-1.5 sm:w-2 sm:h-2 bg-white/30 rounded-full blur-sm"></div>
                    </div>
                    
                    <!-- Brand Logo -->
                    <div class="absolute inset-0 flex items-center justify-center">
                        <div class="text-center">
                            <i class="fas fa-sliders-h text-lg sm:text-2xl text-white drop-shadow-lg"></i>
                        </div>
                    </div>
                    
                    <!-- Shimmer Effect -->
                    <div class="absolute inset-0 rounded-full bg-gradient-to-r from-transparent via-white/30 to-transparent transform -skew-x-12 animate-shimmer"></div>
                    
                    <!-- Pulse Ring -->
                    <div class="absolute inset-0 rounded-full border-2 border-white/20 animate-ping"></div>
                </div>
                
                
                <!-- Expanded Filter Panel -->
                <div id="filter-panel" class="fixed top-0 right-0 w-80 h-full bg-gradient-to-br from-pink-50 via-purple-50 to-indigo-50 dark:from-gray-800 dark:via-gray-700 dark:to-gray-600 shadow-2xl transform translate-x-full transition-all duration-700 ease-out z-50 overflow-y-auto" style="border-radius: 50px 0 0 50px;">
                    <!-- Close Button -->
                    <button onclick="toggleCompact()" class="absolute top-6 left-6 w-10 h-10 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center transition-colors z-20">
                        <i class="fas fa-times"></i>
                    </button>
                    
                    <!-- Filter Content -->
                    <div class="p-6 pt-20 h-full">
                        <!-- Search -->
                        <div class="mb-4">
                            <div class="relative">
                                <input type="text" id="search-input" placeholder="جستجو..." class="w-full p-3 pr-10 border-2 border-pink-200 dark:border-gray-600 bg-white/80 dark:bg-gray-700 backdrop-blur-sm rounded-full focus:outline-none focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition-all duration-300 text-sm">
                                <div class="absolute right-3 top-1/2 transform -translate-y-1/2 text-pink-400">
                                    <i class="fas fa-search"></i>
                                </div>
                            </div>
                        </div>
                        

                        
                        <!-- Category Pills -->
                        <div class="mb-4">
                            <h4 class="text-sm font-bold mb-2 text-center">دسته‌بندی</h4>
                            <div class="flex flex-wrap gap-1 justify-center">
                                <button onclick="setCategoryFilter('')" class="category-pill active px-3 py-1 bg-gradient-to-r from-gray-200 to-gray-300 dark:from-gray-600 dark:to-gray-700 text-gray-700 dark:text-gray-200 rounded-full text-xs font-medium transition-all duration-300 hover:scale-105">
                                    همه
                                </button>
                                {% for category in categories %}
                                <button onclick="setCategoryFilter('{{ category.slug }}')" class="category-pill px-3 py-1 bg-gradient-to-r from-red-200 to-pink-200 text-red-700 rounded-full text-xs font-medium transition-all duration-300 hover:scale-105">
                                    {{ category.icon }} {{ category.name }}
                                </button>
                                {% endfor %}
                            </div>
                        </div>
                        

                        
                        <!-- Brand Pills -->
                        <div class="mb-4">
                            <h4 class="text-sm font-bold mb-2 text-center">برند</h4>
                            <div class="flex flex-wrap gap-1 justify-center">
                                <button onclick="setBrandFilter('')" class="brand-pill active px-3 py-1 bg-gradient-to-r from-gray-200 to-gray-300 dark:from-gray-600 dark:to-gray-700 text-gray-700 dark:text-gray-200 rounded-full text-xs font-medium transition-all duration-300 hover:scale-105">
                                    همه
                                </button>
                                {% for brand in brands %}
                                <button onclick="setBrandFilter('{{ brand.slug }}')" class="brand-pill px-3 py-1 bg-gradient-to-r from-blue-200 to-indigo-200 text-blue-700 rounded-full text-xs font-medium transition-all duration-300 hover:scale-105">
                                    {% if brand.logo %}
                                    <img src="{{ brand.logo.url }}" alt="{{ brand.name }}" class="w-4 h-4 inline-block mr-1 rounded-full">
                                    {% else %}
                                    <i class="fas fa-tag mr-1"></i>
                                    {% endif %}
                                    {{ brand.name }}
                                </button>
                                {% endfor %}
                            </div>
                        </div>
                        
                        <!-- Price Range -->
                        <div class="mb-4">
                            <h4 class="text-sm font-bold mb-2 text-center">قیمت</h4>
                            <div class="grid grid-cols-2 gap-2">
                                <input type="text" id="min-price" placeholder="حداقل" class="p-2 border border-pink-200 dark:border-gray-600 bg-white/70 dark:bg-gray-700 rounded-lg focus:outline-none focus:ring-1 focus:ring-pink-400 text-xs" oninput="formatPriceInput(this)">
                                <input type="text" id="max-price" placeholder="حداکثر" class="p-2 border border-pink-200 dark:border-gray-600 bg-white/70 dark:bg-gray-700 rounded-lg focus:outline-none focus:ring-1 focus:ring-pink-400 text-xs" oninput="formatPriceInput(this)">
                            </div>
                        </div>
                        
                        <!-- Sort -->
                        <div class="mb-4">
                            <h4 class="text-sm font-bold mb-2 text-center">مرتب‌سازی</h4>
                            <select id="sort-filter" class="w-full p-2 border border-purple-200 dark:border-gray-600 bg-white/80 dark:bg-gray-700 rounded-lg focus:outline-none focus:ring-1 focus:ring-purple-400 text-xs appearance-none cursor-pointer">
                                <option value="default">پیش‌فرض</option>
                                <option value="price-low">💰 ارزان‌ترین</option>
                                <option value="price-high">💎 گران‌ترین</option>
                                <option value="rating">⭐ بهترین</option>
                                <option value="name">🔤 الفبایی</option>
                            </select>
                        </div>
                        
                        <!-- Quick Filters -->
                        <div class="mb-4">
                            <h4 class="text-sm font-bold mb-2 text-center">فیلتر سریع</h4>
                            <div class="flex flex-wrap gap-1 justify-center">
                                <button onclick="quickFilter('bestseller')" class="quick-filter-btn px-2 py-1 bg-gradient-to-r from-red-100 to-pink-100 text-red-600 rounded-full text-xs font-medium transition-all duration-300 hover:scale-105 border border-red-200">
                                    🔥 پرفروش
                                </button>
                                <button onclick="quickFilter('discount')" class="quick-filter-btn px-2 py-1 bg-gradient-to-r from-orange-100 to-yellow-100 text-orange-600 rounded-full text-xs font-medium transition-all duration-300 hover:scale-105 border border-orange-200">
                                    💸 تخفیف
                                </button>
                                <button onclick="quickFilter('new')" class="quick-filter-btn px-2 py-1 bg-gradient-to-r from-green-100 to-emerald-100 text-green-600 rounded-full text-xs font-medium transition-all duration-300 hover:scale-105 border border-green-200">
                                    ✨ جدید
                                </button>
                                <button onclick="quickFilter('luxury')" class="quick-filter-btn px-2 py-1 bg-gradient-to-r from-purple-100 to-indigo-100 text-purple-600 rounded-full text-xs font-medium transition-all duration-300 hover:scale-105 border border-purple-200">
                                    👑 لوکس
                                </button>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="flex gap-2 justify-center">
                            <button id="apply-price-filter" class="px-4 py-2 bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white rounded-full font-semibold text-xs transition-all duration-300 transform hover:scale-105 shadow-lg">
                                اعمال
                            </button>
                            <button id="clear-filters-btn" class="px-4 py-2 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white rounded-full font-semibold text-xs transition-all duration-300 transform hover:scale-105 shadow-lg">
                                پاک کردن
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Results Info -->
        <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-4">
                <span id="results-count" class="text-gray-600">نمایش {{ total_products }} محصول</span>
                <div id="active-filters" class="flex gap-2">
                    {% if current_category %}
                    <span class="bg-purple-100 text-purple-600 px-2 py-1 rounded-full text-xs">{{ current_category }}</span>
                    {% endif %}
                    {% if current_brand %}
                    <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-xs">{{ current_brand }}</span>
                    {% endif %}
                    {% if search_query %}
                    <span class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-xs">{{ search_query }}</span>
                    {% endif %}
                </div>
            </div>
            <div class="flex items-center gap-2">
                <button id="grid-view" class="p-2 bg-purple-600 text-white rounded-lg">
                    <i class="fas fa-th"></i>
                </button>
                <button id="list-view" class="p-2 bg-gray-200 text-gray-600 rounded-lg hover:bg-gray-300 transition-colors">
                    <i class="fas fa-list"></i>
                </button>
            </div>
        </div>
        
        <!-- Products Grid -->
        <div id="products-grid" class="products-grid">
            <!-- Products will be loaded here by JavaScript -->
        </div>
        
        <!-- No Results Message -->
        <div id="no-results" class="text-center py-12 hidden">
            <i class="fas fa-search text-6xl text-gray-300 mb-4"></i>
            <h3 class="text-xl font-semibold text-gray-600 mb-2">هیچ محصولی یافت نشد</h3>
            <p class="text-gray-500">لطفاً فیلترهای خود را تغییر دهید یا عبارت جستجوی دیگری را امتحان کنید.</p>
        </div>
        
        <!-- Load More Button -->
        <div id="load-more-container" class="text-center py-8">
            <button id="load-more-btn" onclick="loadMoreProducts()" class="bg-purple-600 hover:bg-purple-700 text-white px-8 py-3 rounded-xl font-semibold transition-colors flex items-center justify-center mx-auto">
                <i class="fas fa-plus ml-2"></i>
                نمایش بیشتر
            </button>
        </div>
        
        <!-- Loading Indicator -->
        <div id="loading-indicator" class="hidden flex justify-center items-center py-8">
            <div class="flex items-center space-x-2 space-x-reverse">
                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-purple-600"></div>
                <span class="text-gray-600 dark:text-gray-400">در حال بارگذاری محصولات بیشتر...</span>
            </div>
        </div>
        
        <!-- End of Products Message -->
        <div id="end-message" class="hidden text-center py-8">
            <div class="text-gray-500 dark:text-gray-400">
                <i class="fas fa-check-circle text-2xl mb-2"></i>
                <p>تمام محصولات نمایش داده شدند</p>
            </div>
        </div>
    </div>
</div>

<script>
// Filter functionality
function toggleCompact() {
    const panel = document.getElementById('filter-panel');
    panel.classList.toggle('translate-x-full');
}











// Add event listeners for price range
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, checking buttons...');
    
    // Debug: Check if buttons exist
    const wishlistButtons = document.querySelectorAll('.wishlist-btn');
    const cartButtons = document.querySelectorAll('.cart-button');
    
    console.log('Found wishlist buttons:', wishlistButtons.length);
    console.log('Found cart buttons:', cartButtons.length);
    
    // Force button visibility
    wishlistButtons.forEach(btn => {
        btn.style.display = 'flex';
        btn.style.opacity = '1';
        btn.style.visibility = 'visible';
        btn.style.zIndex = '999';
        console.log('Wishlist button styles:', btn.style.cssText);
    });
    
    cartButtons.forEach(btn => {
        btn.style.display = 'flex';
        btn.style.opacity = '1';
        btn.style.visibility = 'visible';
        btn.style.zIndex = '999';
        console.log('Cart button styles:', btn.style.cssText);
    });
    
    const minPriceInput = document.getElementById('min-price');
    const maxPriceInput = document.getElementById('max-price');
    const applyBtn = document.querySelector('button[onclick="applyFilters()"]');
    const clearBtn = document.querySelector('button[onclick="clearFilters()"]');
    
    // Price inputs - format on input
    if (minPriceInput) {
        minPriceInput.addEventListener('input', formatPriceInput);
    }
    
    if (maxPriceInput) {
        maxPriceInput.addEventListener('input', formatPriceInput);
    }
    
    // Apply button - only for price range
    if (applyBtn) {
        applyBtn.addEventListener('click', function(e) {
            e.preventDefault();
            applyPriceFilters();
        });
    }
    
    // Clear button
    if (clearBtn) {
        clearBtn.addEventListener('click', function(e) {
            e.preventDefault();
            clearFilters();
        });
    }
    
    // New button IDs
    const applyPriceBtn = document.getElementById('apply-price-filter');
    const clearFiltersBtn = document.getElementById('clear-filters-btn');
    
    if (applyPriceBtn) {
        applyPriceBtn.addEventListener('click', function(e) {
            e.preventDefault();
            applyPriceFilters();
        });
    }
    
    if (clearFiltersBtn) {
        clearFiltersBtn.addEventListener('click', function(e) {
            e.preventDefault();
            clearFilters();
        });
    }
    
    // Sort filter
    const sortFilter = document.getElementById('sort-filter');
    if (sortFilter) {
        sortFilter.addEventListener('change', function() {
            activeFilters.sort = this.value;
            filterProducts();
        });
    }
    
    // View toggle buttons
    const gridViewBtn = document.getElementById('grid-view');
    const listViewBtn = document.getElementById('list-view');
    
    if (gridViewBtn) {
        gridViewBtn.addEventListener('click', function() {
            toggleView('grid');
        });
    }
    
    if (listViewBtn) {
        listViewBtn.addEventListener('click', function() {
            toggleView('list');
        });
    }
});

function clearFilters() {
    console.log('Clearing all filters');
    
    // Reset all form elements
    document.getElementById('search-input').value = '';
    document.getElementById('min-price').value = '';
    document.getElementById('max-price').value = '';
    document.getElementById('sort-filter').value = 'default';
    document.getElementById('category-filter').value = '';
    document.getElementById('brand-filter').value = '';
    
    // Reset all filters
    activeFilters = {
        search: '',
        category: '',
        brand: '',
        sort: 'default',
        minPrice: null,
        maxPrice: null,
        quickFilter: null
    };
    
    // Reset all pills and buttons
    document.querySelectorAll('.category-pill, .brand-pill, .quick-filter-btn').forEach(element => {
        element.classList.remove('active');
    });
    
    // Set first pills as active
    const firstCategoryPill = document.querySelector('.category-pill');
    const firstBrandPill = document.querySelector('.brand-pill');
    
    if (firstCategoryPill) firstCategoryPill.classList.add('active');
    if (firstBrandPill) firstBrandPill.classList.add('active');
    
    console.log('Filters cleared, calling filterProducts');
    filterProducts();
}

function toggleView(view) {
    const gridView = document.getElementById('grid-view');
    const listView = document.getElementById('list-view');
    const productsGrid = document.getElementById('products-grid');
    
    if (view === 'grid') {
        gridView.classList.add('bg-purple-600', 'text-white');
        gridView.classList.remove('bg-gray-200', 'text-gray-600');
        listView.classList.add('bg-gray-200', 'text-gray-600');
        listView.classList.remove('bg-purple-600', 'text-white');
        productsGrid.classList.remove('grid-cols-1');
        productsGrid.classList.add('products-grid');
        
        // Remove list view classes from all product cards
        document.querySelectorAll('.product-card').forEach(card => {
            card.classList.remove('list-view');
        });
        
        console.log('Switched to grid view');
    } else {
        listView.classList.add('bg-purple-600', 'text-white');
        listView.classList.remove('bg-gray-200', 'text-gray-600');
        gridView.classList.add('bg-gray-200', 'text-gray-600');
        gridView.classList.remove('bg-purple-600', 'text-white');
        productsGrid.classList.remove('products-grid');
        productsGrid.classList.add('grid-cols-1');
        
        // Add list view classes to all product cards
        document.querySelectorAll('.product-card').forEach(card => {
            card.classList.add('list-view');
        });
        
        console.log('Switched to list view');
    }
}

function addToCart(productId) {
    // TODO: Implement cart functionality
    console.log('Adding product to cart:', productId);
    
    // Show success message
    const button = event.target.closest('.cart-button');
    const originalText = button.innerHTML;
    button.innerHTML = '<i class="fas fa-check"></i>';
    button.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
    
    setTimeout(() => {
        button.innerHTML = originalText;
        button.style.background = 'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)';
    }, 1500);
}

function addToWishlist(productId, event) {
    event.stopPropagation(); // Prevent card click
    
    const button = event.target.closest('.wishlist-btn');
    const icon = button.querySelector('i');
    
    if (icon.classList.contains('far')) {
        // Add to wishlist
        icon.classList.remove('far');
        icon.classList.add('fas');
        button.style.background = 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
        console.log('Added to wishlist:', productId);
    } else {
        // Remove from wishlist
        icon.classList.remove('fas');
        icon.classList.add('far');
        button.style.background = 'linear-gradient(135deg, #6b7280 0%, #4b5563 100%)';
        console.log('Removed from wishlist:', productId);
    }
}

function openProductDetail(productId) {
    window.location.href = `/shop/product/${productId}/`;
}


</script>
{% endblock %} 