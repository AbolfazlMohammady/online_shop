from django.core.management.base import BaseCommand
from django.contrib.auth import get_user_model
from blog.models import Post
from django.utils import timezone
from datetime import timedelta
import random

class Command(BaseCommand):
    help = 'ایجاد داده‌های نمونه برای بلاگ'

    def handle(self, *args, **options):
        # ایجاد کاربر نمونه اگر وجود نداشته باشد
        User = get_user_model()
        user, created = User.objects.get_or_create(
            username='admin',
            defaults={
                'email': 'admin@example.com',
                'first_name': 'مدیر',
                'last_name': 'سیستم',
                'is_staff': True,
                'is_superuser': True
            }
        )
        if created:
            user.set_password('admin123')
            user.save()
            self.stdout.write(self.style.SUCCESS('کاربر ادمین ایجاد شد'))

        # داده‌های نمونه مقالات
        sample_posts = [
            {
                'title': 'راهنمای کامل مراقبت از پوست در فصل زمستان',
                'content': '''
                فصل زمستان با هوای سرد و خشک خود می‌تواند تأثیرات منفی بر پوست شما بگذارد. در این مقاله، راه‌های مؤثر برای مراقبت از پوست در این فصل را بررسی می‌کنیم.

                ## نکات مهم مراقبت از پوست در زمستان:

                ### 1. استفاده از مرطوب‌کننده قوی
                در فصل زمستان، پوست شما به مرطوب‌کننده‌های قوی‌تری نیاز دارد. محصولاتی که حاوی هیالورونیک اسید، گلیسیرین یا سرامید هستند، انتخاب‌های مناسبی هستند.

                ### 2. محافظت در برابر آفتاب
                حتی در زمستان، اشعه‌های مضر خورشید می‌توانند به پوست آسیب برسانند. استفاده از کرم ضد آفتاب با SPF حداقل 30 ضروری است.

                ### 3. پاکسازی ملایم
                از پاک‌کننده‌های ملایم استفاده کنید که پوست را خشک نکنند. محصولاتی که حاوی مواد مرطوب‌کننده هستند، گزینه‌های بهتری هستند.

                ### 4. استفاده از سرم‌های تقویتی
                سرم‌های حاوی ویتامین C، رتینول یا پپتیدها می‌توانند به تقویت و جوان‌سازی پوست کمک کنند.

                با رعایت این نکات، می‌توانید پوستی سالم و درخشان در طول فصل زمستان داشته باشید.
                ''',
                'category': 'مراقبت پوست',
                'tags': 'مراقبت پوست,زمستان,مرطوب‌کننده,ضد آفتاب',
                'is_featured': True
            },
            {
                'title': 'بهترین رژ لب‌های مات برای لب‌های خشک',
                'content': '''
                رژ لب‌های مات محبوبیت زیادی دارند، اما برای افرادی که لب‌های خشک دارند، انتخاب محصول مناسب اهمیت زیادی دارد.

                ## ویژگی‌های رژ لب مناسب برای لب‌های خشک:

                ### 1. فرمولاسیون مرطوب‌کننده
                رژ لب‌هایی که حاوی مواد مرطوب‌کننده مانند روغن جوجوبا، شی باتر یا ویتامین E هستند، انتخاب‌های مناسبی هستند.

                ### 2. بافت کرمی
                رژ لب‌های با بافت کرمی به جای بافت خشک، راحت‌تر روی لب‌های خشک پخش می‌شوند.

                ### 3. رنگ‌های مناسب
                رنگ‌های تیره می‌توانند خشکی لب‌ها را بیشتر نمایان کنند. رنگ‌های روشن‌تر و طبیعی‌تر انتخاب بهتری هستند.

                ### 4. آماده‌سازی لب‌ها
                قبل از استفاده از رژ لب، حتماً لب‌ها را با اسکراب ملایم و مرطوب‌کننده آماده کنید.

                با انتخاب محصول مناسب و مراقبت صحیح، می‌توانید از زیبایی رژ لب‌های مات لذت ببرید.
                ''',
                'category': 'آرایش',
                'tags': 'رژ لب,مات,لب خشک,آرایش',
                'is_featured': True
            },
            {
                'title': 'راهنمای انتخاب عطر مناسب برای هر فصل',
                'content': '''
                انتخاب عطر مناسب برای هر فصل می‌تواند تأثیر زیادی بر شخصیت و جذابیت شما داشته باشد.

                ## عطرهای مناسب برای هر فصل:

                ### بهار
                عطرهای سبک و گل‌دار با نت‌های تازه و شاداب مناسب فصل بهار هستند. رایحه‌هایی مانند یاس، لیلک و مرکبات انتخاب‌های مناسبی هستند.

                ### تابستان
                در تابستان، عطرهای سبک و خنک با نت‌های دریایی، مرکبات و گیاهان معطر مناسب هستند. از عطرهای سنگین و گرم پرهیز کنید.

                ### پاییز
                عطرهای گرم و عمیق با نت‌های چوبی، مشک و وانیل برای فصل پاییز مناسب هستند. این عطرها حس گرمی و راحتی را منتقل می‌کنند.

                ### زمستان
                عطرهای سنگین و گرم با نت‌های شرقی، چوبی و ادویه‌ای برای زمستان مناسب هستند. این عطرها حس لوکس و گرمی را منتقل می‌کنند.

                انتخاب عطر مناسب می‌تواند تأثیر زیادی بر خلق و خو و اعتماد به نفس شما داشته باشد.
                ''',
                'category': 'عطر',
                'tags': 'عطر,فصل,رایحه,لوکس',
                'is_featured': False
            },
            {
                'title': 'نکات مهم برای مراقبت از مو در خانه',
                'content': '''
                مراقبت صحیح از مو در خانه می‌تواند تأثیر زیادی بر سلامت و زیبایی موهای شما داشته باشد.

                ## نکات مهم مراقبت از مو:

                ### 1. شستشوی صحیح
                موهای خود را با آب ولرم بشویید و از آب داغ پرهیز کنید. شامپو را فقط روی پوست سر استفاده کنید.

                ### 2. استفاده از نرم‌کننده
                نرم‌کننده را فقط روی ساقه مو استفاده کنید و اجازه دهید 3-5 دقیقه بماند.

                ### 3. خشک کردن ملایم
                موها را با حوله به آرامی خشک کنید و از مالش شدید پرهیز کنید.

                ### 4. استفاده از محصولات محافظ
                قبل از استفاده از ابزارهای حرارتی، حتماً از محصولات محافظ استفاده کنید.

                ### 5. تغذیه مناسب
                رژیم غذایی سرشار از پروتئین، ویتامین‌ها و مواد معدنی برای سلامت مو ضروری است.

                با رعایت این نکات، می‌توانید موهایی سالم و زیبا داشته باشید.
                ''',
                'category': 'مراقبت مو',
                'tags': 'مراقبت مو,شامپو,نرم‌کننده,تغذیه',
                'is_featured': False
            },
            {
                'title': 'راهنمای کامل آرایش چشم برای مبتدیان',
                'content': '''
                آرایش چشم می‌تواند یکی از چالش‌برانگیزترین بخش‌های آرایش باشد. در این راهنما، نکات مهم برای آرایش چشم را بررسی می‌کنیم.

                ## مراحل آرایش چشم:

                ### 1. آماده‌سازی
                ابتدا پلک‌ها را با پرایمر آماده کنید تا آرایش ماندگاری بیشتری داشته باشد.

                ### 2. سایه چشم
                از رنگ‌های روشن در گوشه داخلی چشم و رنگ‌های تیره در گوشه خارجی استفاده کنید.

                ### 3. خط چشم
                خط چشم را از گوشه داخلی شروع کرده و به سمت خارج بکشید. برای مبتدیان، خط چشم مایع راحت‌تر است.

                ### 4. ریمل
                ریمل را از ریشه مژه‌ها شروع کرده و به سمت نوک مژه‌ها بکشید.

                ### 5. ابرو
                ابروها را با مداد یا پودر پر کنید تا تعادل چهره حفظ شود.

                با تمرین و صبر، می‌توانید مهارت آرایش چشم خود را بهبود دهید.
                ''',
                'category': 'آرایش',
                'tags': 'آرایش چشم,سایه,خط چشم,ریمل',
                'is_featured': False
            },
            {
                'title': 'بهترین محصولات ضد پیری برای پوست',
                'content': '''
                محصولات ضد پیری می‌توانند به جوان‌سازی و بهبود ظاهر پوست کمک کنند. در این مقاله، بهترین محصولات ضد پیری را معرفی می‌کنیم.

                ## محصولات مؤثر ضد پیری:

                ### 1. رتینول
                رتینول یکی از مؤثرترین مواد ضد پیری است که تولید کلاژن را افزایش می‌دهد.

                ### 2. ویتامین C
                ویتامین C یک آنتی‌اکسیدان قوی است که از پوست در برابر رادیکال‌های آزاد محافظت می‌کند.

                ### 3. هیالورونیک اسید
                هیالورونیک اسید رطوبت پوست را حفظ کرده و خطوط ریز را کاهش می‌دهد.

                ### 4. پپتیدها
                پپتیدها به تولید کلاژن کمک کرده و پوست را سفت می‌کنند.

                ### 5. آلفا هیدروکسی اسیدها
                این اسیدها سلول‌های مرده پوست را لایه‌برداری کرده و پوست را درخشان می‌کنند.

                استفاده منظم از این محصولات می‌تواند تأثیر قابل توجهی بر جوان‌سازی پوست داشته باشد.
                ''',
                'category': 'مراقبت پوست',
                'tags': 'ضد پیری,رتینول,ویتامین C,کلاژن',
                'is_featured': True
            }
        ]

        # ایجاد مقالات
        for i, post_data in enumerate(sample_posts):
            # تاریخ انتشار تصادفی در 30 روز گذشته
            days_ago = random.randint(0, 30)
            published_date = timezone.now() - timedelta(days=days_ago)
            
            post, created = Post.objects.get_or_create(
                title=post_data['title'],
                defaults={
                    'slug': f"post-{i+1}",
                    'author': user,
                    'content': post_data['content'],
                    'excerpt': post_data['content'][:200] + "...",
                    'category': post_data['category'],
                    'tags': post_data['tags'],
                    'status': 'published',
                    'published_at': published_date,
                    'is_featured': post_data['is_featured'],
                    'view_count': random.randint(10, 500)
                }
            )
            
            if created:
                self.stdout.write(
                    self.style.SUCCESS(f'مقاله "{post.title}" ایجاد شد')
                )
            else:
                self.stdout.write(
                    self.style.WARNING(f'مقاله "{post.title}" قبلاً وجود دارد')
                )

        self.stdout.write(
            self.style.SUCCESS('داده‌های نمونه بلاگ با موفقیت ایجاد شدند')
        )
